# Deployment Pipeline

We will now create a deployment pipeline using GitHub Actions. Applying multiple files gets cumbersome, we can use Kustomize to do this. To do this, we will create a filed `kustomization.yaml` in the root directory:

```yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - manifests/deployment.yaml
  - manifests/service.yaml
```

Now we can deploy this using the `-k` flag: `kubectl apply -k .`

Next, we can individually choose which images to deploy:

```yaml
# ...
images:
  - name: PROJECT/IMAGE
    newName: jakousa/colorcontent
```

Lastly, we will have a deployment.yaml with a placeholder for the image:

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: dwk-environments
spec:
  replicas: 1
  selector:
    matchLabels:
      app: dwk-environments
  template:
    metadata:
      labels:
        app: dwk-environments
    spec:
      containers:
        - name: dwk-environments
          image: jakousa/colorcontent
```
